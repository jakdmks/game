<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Sweet bro.</title>
    <link rel="stylesheet" href="./style.css">
    <!--<link rel="icon" href="./favicon.ico" type="image/x-icon">-->
  </head>
  <body>
    <main>
	
		<!--OVERLAY-->
		<div id="overlay" class="overlay">
			<div style="width: 700px;">
				<div id="overlay-text">Picking 2 sweets at random...</div>
				<div id="overlay-images" class="overlay-images"></div>
			</div>
		</div>
		
		<!--END OF CREDIT OVERLAY-->
		<div class="overlay-dismiss" id="overlay-end-of-credit">
			<div>
				<div id="overlay-end-of-credit-content" style="text-align: left"></div>
				<button class="dismiss-button" id="overlay-end-of-credit-dismiss-button" onclick="hideOverlayDismiss()">Dismiss</button>
			</div>
		</div>
				
		<div class="grid-container">
		  <!-- First Row of 3 Columns -->
		  <div class="grid-item" style="text-align: right">
			<!--ADD CREDIT-->
			<div>
				<!--<h2 style="text-align: center">Add Credit</h2>-->
				<div>
					<!--
					<div id="credit-button" class="credit-button-div">
						<button type="button" onclick="console.info(addCredit(20000))">Add 20,000 Tokens for only £20</button>
					</div>
					-->
					<div id="credit-button" class="credit-button-div">
						<button type="button" onclick="console.info(addCredit(10000))">Add 10,000 Tokens for only £10</button>
					</div>
					<div id="convert-winnings-to-credit-button" class="convert-button-div">
						<button type="button"  onclick="console.info(convertWinnings())">Convert Winnings to Credit</button>
					</div>
				</div>
			</div>
			
			<!--CREDIT-->
			<div>
				<!--<h2>Credit</h2>-->
				<div class="panel green">
					<div id="cust-credit">Credit: X Tokens</div>
					<div id="cust-winnings">Winnings: X Tokens</div>
					<div id="cust-total-winnings">Overall Winnings: X Tokens</div>
				</div>
			</div>
			
			<!--PAYOUT-SPLIT STATS-->
			<div>
				<!--<h2>Split</h2>-->
				<div class="panel">
					<div id="payout-pct">Return Pct: X%</div>
					<div id="insurance-pct">Insurance Pct: X%</div>
				</div>
			</div>
		  </div>
		  <div class="grid-item" style="padding-right: 15px;">
			<div>
				<!--<h2>Payout Split</h2>-->
				<div class="radio-group" style="display: block; font-size: 1.5em; text-align: left">
					<label class="radio-item">
					<!--<input type="radio" name="payout" value="option1" onchange="updatePayoutSplit(2.5, 0, 'SPLIT01')">-->
					<input type="radio" name="payout" value="option1" onchange="updatePayoutSplit(2.4, 0, 'SPLIT01')">
						<strong>HIGHER PAYOUT</strong>
						<!--<div style="font-size: 0.5em;">250% Win Payout Rate (with upto +40% bonus!)</div>
						<div style="font-size: 0.5em;">0% Insurance Payout Rate</div>-->
						<div id="payout-split-bar-250-0" class="payout-split-bar">
							<div class="green-bar" style="width: 86%;"></div>
							<div id="payout-split-bar-250-0-green-boost" class="green-bar-boost"></div>
							<div class="blue-bar" style="width: 0px;"></div>
						</div>

					</label>
					
					<label class="radio-item">
					<!--<input type="radio" name="payout" value="option1" checked onchange="updatePayoutSplit(2, 0.5, 'SPLIT02')">-->
					<input type="radio" name="payout" value="option1" checked onchange="updatePayoutSplit(1.9, 0.5, 'SPLIT02')">
						<strong>VANILLA</strong>
						<!--<div style="font-size: 0.5em;">200% Win Payout Rate (with upto +40% boost!)</div>
						<div style="font-size: 0.5em;">50% Insurance Payout Rate (with upto +40% boost!)</div>-->
						<div id="payout-split-bar-200-50" class="payout-split-bar selected">
							<div class="green-bar"></div>
							<div id="payout-split-bar-200-50-green-boost" class="green-bar-boost"></div>
							<div id="payout-split-bar-200-50-red-boost" class="blue-bar-boost"></div>
							<div class="blue-bar"></div>
						</div>
					</label>
					
					<label class="radio-item">
					<!--<input type="radio" name="payout" value="option1" onchange="updatePayoutSplit(1.5, 1, 'SPLIT03')">-->
					<input type="radio" name="payout" value="option1" onchange="updatePayoutSplit(1.5, 0.9, 'SPLIT03')">
						<strong>HIGHER INSURANCE</strong>
						<!--<div style="font-size: 0.5em;">150% Win Payout Rate (with upto +40% boost!)</div>
						<div style="font-size: 0.5em;">100% Insurance Payout Rate (with upto +40% boost!)</div>-->
						<div id="payout-split-bar-150-100" class="payout-split-bar">
							<div class="green-bar" style="width: 52%;"></div>
							<div id="payout-split-bar-150-100-green-boost" class="green-bar-boost"></div>
							<div id="payout-split-bar-150-100-red-boost" class="blue-bar-boost"></div>
							<div class="blue-bar" style="width: 34%;"></div>
						</div>
					</label>
				</div>
			</div>
		  </div>
		  <div class="grid-item" style="text-align: left">
			<!--WIN STREAK GRAPHICAL DISPLAY-->
			<div style="display: inline-block">
				<span id="win-streak-text" class="boost-medium grey">streak x</span><span id="win-streak-num" class="boost-large grey">X</span>
			</div>
			<!--BOOST GRAPHICAL DISPLAY-->
			<div style="display: inline-block">
				&nbsp;&nbsp;&nbsp;
				<span id="boost-graphic-1" class="boost-small grey">BO</span><span id="boost-graphic-2" class="boost-medium grey">OS</span><span id="boost-graphic-3" class="boost-large grey">T!!!</span>
			</div>

			<!--Payout Boost-->
			<div style="border: none">
				<div class="radio-group" id="payout-boost-icons" style="display: none; font-size: 1.5em; text-align: left">
					<input type="radio" id="boost-payout" name="boost-type" value="boost-payout" onchange="applyBoost('payout', this.checked)">
				</div>
				<div class="slide-in-scale" id="payout-boost-icon-1" style="margin-left: 10px;">
					<img src="images/flame-png.png" height="30px" alt="Flame Icon">
					<div id="payout-boost-pct-1" class="payout-boost-text small">20%</div>
				</div>
				<div class="slide-in-scale" id="payout-boost-icon-2" style="margin-left: 10px;">
					<img src="images/flame-png.png" height="40px" alt="Flame Icon">
					<div id="payout-boost-pct-2" class="payout-boost-text medium">30%</div>
				</div>
				<div class="slide-in-scale" id="payout-boost-icon-3" style="margin-left: 10px;">
					<img src="images/flame-png.png" height="50px" alt="Flame Icon">
					<div id="payout-boost-pct-3" class="payout-boost-text large">40%</div>
				</div>
			</div>
			<!--Insurance Boost-->
			<div style="border: none">
				<div class="radio-group" id="insurance-boost-icons" style="display: none; font-size: 1.5em; text-align: left">
					<input type="radio" id="insurance-payout" name="boost-type" value="boost-insurance" onchange="applyBoost('insurance', this.checked)">
				</div>
				<div class="slide-in-scale" id="insurance-boost-icon-1" style="margin-left: 10px;">
					<img src="images/green-cross-png.png" height="30px" alt="Insurance Boost 1">
					<div id="insurance-boost-pct-1" class="payout-boost-text small">20%</div>
				</div>
				<div class="slide-in-scale" id="insurance-boost-icon-2" style="margin-left: 10px;">
					<img src="images/green-cross-png.png" height="40px" alt="Insurance Boost 2">
					<div id="insurance-boost-pct-2" class="payout-boost-text medium">30%</div>
				</div>
				<div class="slide-in-scale" id="insurance-boost-icon-3" style="margin-left: 10px;">
					<img src="images/green-cross-png.png" height="50px" alt="Insurance Boost 3">
					<div id="insurance-boost-pct-3" class="payout-boost-text large">40%</div>
				</div>
			</div>
		  </div>
		  
		  <!-- Error Column -->
		  <div class="grid-item two-column-span">
			<div id="error-container" style="display: none; text-align: center">
				<div class="column" id="error-content" style="text-align: center"></div>
			</div>
		  </div>
		  
		  <div class="grid-item" style="text-align: left">
				<div class="boost-insurance-div" style="display: inline-block">
					<input type="checkbox" id="boost-insurance-checkbox" name="boost-insurance-checkbox" onchange="insuranceSwitch(this.checked)" />
					<label for="boost-insurance-checkbox">Streak Protection?</label>
					<div style="font-size: 0.65em; font-style: italic">Pays out 20% less on boosts but your streak maintains on mixed pair</div>
				</div>
				<!--<div style="font-size: 0.8em;"><em>(Can only change once win streak returns to 0)</em></div>-->
		  </div>

		  <!-- Second Row of 3 Columns -->
		  <div class="grid-item" style="text-align: right">
			<div class="cherry-cola-bets-container">
				<div class="cherry-cola-bets">
					<div class="game-button-container cherry">
						<button type="button" onclick="pickSweets(100, 'Cherry')">BET 100 CHERRY</button>
					</div>
					<div class="game-button-container cherry large-bet">
						<button type="button" onclick="pickSweets(500, 'Cherry')">BET 500<br />CHERRY</button>
					</div>
					<div class="game-button-container cola">
						<button type="button" onclick="pickSweets(100, 'Cola')">BET 100 COLA</button>
					</div>
					<div class="game-button-container cola large-bet">
						<button type="button" onclick="pickSweets(500, 'Cola')">BET 500 COLA</button>
					</div>
				</div>
			</div>
		  </div>
		  <div class="grid-item">
			<div style="">
				<div>
					<div class="result-div" id="result"></div>
				</div>
				<div>
					<div class="payout-div" id="payout"></div>
				</div>
				<div class="stake-bet-container">
					<div class="stake-bet-div" id="stake"></div>
					<div class="stake-bet-div" id="bet"></div>
				</div>
				
				<!--FLYING POINTS-->
				<div>
					<div class="flying-text-container">
						<!-- Flying text will be added here dynamically -->
					</div>
				</div>
				
			</div>
		  </div>
		  <div class="grid-item">  
			<!--SWEET BAG NEW SPOT-->
			<div id="outcome-images" class="panel" style="display: none; width: 100%">
				<div style="display: block">
					<h2 style="margin-bottom: 10px;">Sweet 1</h2>
					<div id="sweet-image1" class="sweet-image" style=""></div>
				</div>
				<div style="display: block">
					<h2 style="margin-bottom: 10px;">Sweet 2</h2>
					<div id="sweet-image2" class="sweet-image" style=""></div>
				</div>
			</div>
			
			<div>
				<div class="panel" style="display: none" id="result-description"></div>
			</div>
			
			<!--SWEET BAG NEW SPOT-->
		  </div>

			<!-- Single Column Rows -->
			<div class="grid-item full-width">
				<div>
					<div class="last-picks-container" id="last-picks-display"></div>
					<div class="last-picks-container latest" id="last-picks-display-latest"></div>
				</div>
			</div>
			
			<div class="grid-item full-width" style="text-align: left;">
				<div class="panel debug" id="debug">
					<div id="house-balance-debug">House Balance: X Tokens</div>
					<div id="house-cash-debug">House Balance: £XX.XX</div>
					<div id="cust-balance-debug">Cust' Balance: X Tokens</div>
					<div id="cust-cash-debug">Cust' Balance: £XX.XX</div>
					<div id="boost-insurance">Boost Insurance: X</div>
					<div id="boost-insurance-multiplier">Boost Insurance Multiplier: X</div>
					<div id="payout-multiplier">Win Multiplier: X</div>
					<div id="insurance-multiplier">Insurance Multiplier: X</div>
					<div id="win-streak">Win Streak: X</div>
					<div id="boost-avail">Boost Available: X</div>
					<div id="boost-applied">Boost Applied: X</div>
					<div id="boost-level">Boost Level: X</div>
					<div id="boost-pct">Boost Pct: X%</div>
					<div id="payout-bonus">Last Bet Return Bonus Rate: X%</div>
					<div id="insurance-bonus">Last Bet Insurance Bonus Rate: X%</div>
				</div>
			</div>
		</div>
    </main>
    <script>
		//TODO: If Boost Insurance is switched on... it can only be switched off when they're back to 0?
	
		function updateStatisticsDivs() {
			custCreditDiv.innerHTML = "Credit: " + playerCredit + " Tokens";
			custWinningsDiv.innerHTML = "Winnings: " + statistics.playerWinnings + " Tokens";
			custTotalWinningsDiv.innerHTML = "Overall Winnings: " + statistics.playerTotalWinnings + " Tokens";
			houseBalanceDebugDiv.innerHTML = "House Balance: " + statistics.houseBalance + " Tokens";
			houseCashDebugDiv.innerHTML = "House Balance: " + (statistics.houseBalance / tokenRateToGBP) + " GBP";
			custBalanceDebugDiv.innerHTML = "Cust' Balance: " + statistics.playerBalance + " Tokens";
			custCashDebugDiv.innerHTML = "Cust' Balance: " + (statistics.playerBalance / tokenRateToGBP) + " GBP";
			
			winStreakDiv.innerHTML = "Win Streak: " + winStreak;
			boostAvailDiv.innerHTML = "Boost Available: " + boostAvailable;
			boostAppliedDiv.innerHTML = "Boost Applied: " + boostApplied;
			boostLevelDiv.innerHTML = "Boost Level: " + boostLevel;
			boostPctDiv.innerHTML = "Boost Pct: " + (boostRate * 100).toFixed(0) + "%";
			boostInsuranceDiv.innerHTML = "Boost Insurance: " + boostInsurance;
			boostInsuranceMultiplierDiv.innerHTML = "Rate: " + boostInsuranceRate;
			
			payoutPctDiv.innerHTML = "Return Pct: " + (payoutRate * 100).toFixed(0) + "%" + (payoutBoost === true ? " (+" + (boostRate * 100).toFixed(0) + "% boost)" : "");
			insurancePctDiv.innerHTML = "Insurance Pct: " + (insuranceRate * 100).toFixed(0) + "%" + (insuranceBoost === true ? " (+" + (boostRate * 100).toFixed(0) + "% boost)" : "");
			payoutMultiplierDiv.innerHTML = "Win Multiplier: " + payoutRate;
			insuranceMultiplierDiv.innerHTML = "Insurance Multiplier: " + insuranceRate;
			
			payoutBonusDiv.innerHTML = "Last Bet Return Bonus Rate:  " + (payoutBoostRate * 100).toFixed(0) + "%";
			insuranceBonusDiv.innerHTML = "Last Bet Insurance Bonus Rate: " + (insuranceBoostRate * 100).toFixed(0) + "%";
			
			//Player Credit Panel Colour (TODO: Re-implement this...)
			var playerCreditParentDiv = custCreditDiv.parentNode;
			if (playerCredit <= 0) {
				playerCreditParentDiv.classList.remove("green");
				playerCreditParentDiv.classList.add("red");		
				creditButtonDiv.style.pointerEvents = "auto";
				creditButtonDiv.style.opacity = "1";
			} else {
				playerCreditParentDiv.classList.add("green");
				playerCreditParentDiv.classList.remove("red");
				creditButtonDiv.style.pointerEvents = "none";
				creditButtonDiv.style.opacity = "0.2";
			}
			
			//Convert Winnings to Credit 
			//convertWinningsToCreditButtonDiv
			if (statistics.playerWinnings > 0) {			
				convertWinningsToCreditButtonDiv.style.pointerEvents = "auto";
				convertWinningsToCreditButtonDiv.style.opacity = "1";
			} else {
				convertWinningsToCreditButtonDiv.style.pointerEvents = "none";
				convertWinningsToCreditButtonDiv.style.opacity = "0.2";
			}
			
			//Displaying Bonus Buttons - move to another function?
			console.info("boostAvailable", boostAvailable);
			
			if (boostAvailable) {
				
				console.info("######boostRate", boostRate);
				
				if (boostLevel >= 1) {
					boostGraphic1Span.classList.add("selected");
					payoutBoostIconsDiv.style.display = "inline-block";
					payoutBoostIcon1Div.style.display = "inline-block";
					payoutBoostPct1Div.innerHTML = "+" + ((boostBonusLevelOne - boostInsuranceRate) * 100).toFixed(0) + "%";
					
					if (insuranceRate > 0) {
						insuranceBoostIconsDiv.style.display = "inline-block";
						insuranceBoostIcon1Div.style.display = "inline-block";
						insuranceBoostPct1Div.innerHTML = "+" + ((boostBonusLevelOne - boostInsuranceRate) * 100).toFixed(0) + "%";
					} else {
						insuranceBoostIconsDiv.style.display = "none";
						insuranceBoostIcon1Div.style.display = "none";
					}
					
				}
				if (boostLevel >= 2) {
					boostGraphic2Span.classList.add("selected");
					payoutBoostIcon2Div.style.display = "inline-block";
					payoutBoostPct2Div.innerHTML = "+" + ((boostBonusLevelOne + boostBonusLevelTwoHop - boostInsuranceRate) * 100).toFixed(0) + "%";
					payoutBoostPct1Div.classList.add("strikethrough");
					
					if (insuranceRate > 0) {
						insuranceBoostIcon2Div.style.display = "inline-block";
						insuranceBoostPct2Div.innerHTML = "+" + ((boostBonusLevelOne + boostBonusLevelTwoHop - boostInsuranceRate) * 100).toFixed(0) + "%";
						insuranceBoostPct1Div.classList.add("strikethrough");
					} else {
						insuranceBoostIcon2Div.style.display = "none";
					}
				}
				if (boostLevel === 3) {
					boostGraphic3Span.classList.add("selected");
					payoutBoostIcon3Div.style.display = "inline-block";
					payoutBoostPct3Div.innerHTML = "+" + ((boostBonusLevelOne + boostBonusLevelTwoHop + boostBonusLevelThreeHop - boostInsuranceRate) * 100).toFixed(0) + "%";
					payoutBoostPct2Div.classList.add("strikethrough");
					
					if (insuranceRate > 0) {
						insuranceBoostIcon3Div.style.display = "inline-block";
						insuranceBoostPct3Div.innerHTML = "+" + ((boostBonusLevelOne + boostBonusLevelTwoHop + boostBonusLevelThreeHop - boostInsuranceRate) * 100).toFixed(0) + "%";
						insuranceBoostPct2Div.classList.add("strikethrough");
					} else {
						insuranceBoostIcon3Div.style.display = "none";
					}
				}
			} else {
				payoutBoostIconsDiv.style.display = "none";
				payoutBoostIcon1Div.style.display = "none";
				payoutBoostIcon2Div.style.display = "none";
				payoutBoostIcon3Div.style.display = "none";
				
				insuranceBoostIconsDiv.style.display = "none";
				insuranceBoostIcon1Div.style.display = "none";
				insuranceBoostIcon2Div.style.display = "none";
				insuranceBoostIcon3Div.style.display = "none";
				
				payoutBoostPct1Div.classList.remove("strikethrough");
				insuranceBoostPct1Div.classList.remove("strikethrough");
				payoutBoostPct2Div.classList.remove("strikethrough");
				insuranceBoostPct2Div.classList.remove("strikethrough");
				
				boostGraphic1Span.classList.remove("selected");
				boostGraphic2Span.classList.remove("selected");
				boostGraphic3Span.classList.remove("selected");
			}
			
			winStreakNumSpan.innerHTML = winStreak;
			
			if (boostLevel >= 3) {
				winStreakNumSpan.classList.add("red");
				winStreakNumSpan.classList.add("glowing");
				winStreakNumSpan.classList.remove("orange");
				winStreakNumSpan.classList.remove("yellow");
			} else if (boostLevel >= 2) {
				winStreakNumSpan.classList.remove("red");
				winStreakNumSpan.classList.add("orange");
				winStreakNumSpan.classList.add("glowing");
				winStreakNumSpan.classList.remove("yellow");
			} else if (boostLevel >= 1) {
				winStreakNumSpan.classList.remove("red");
				winStreakNumSpan.classList.remove("orange");
				winStreakNumSpan.classList.add("yellow");
				winStreakNumSpan.classList.add("glowing");
			} else {
				winStreakNumSpan.classList.remove("red", "glowing");
				winStreakNumSpan.classList.remove("orange", "glowing");
				winStreakNumSpan.classList.remove("yellow", "glowing");
			}
		}
		
		function updatePayoutSplit(newPayoutRate = 0, newInsuranceRate = 0, option="") {
			console.info("Running updatePayoutSplit()");
			console.info("newPayoutRate", newPayoutRate);
			console.info("newInsuranceRate", newInsuranceRate);
			
			payoutSplitCode = option;
			console.info("payoutSplitCode", payoutSplitCode);
			
			if (option === "SPLIT01") {
				split01Div.classList.add("selected");
				split02Div.classList.remove("selected");
				split03Div.classList.remove("selected");
			} else if (option === "SPLIT02") {
				split01Div.classList.remove("selected");
				split02Div.classList.add("selected");
				split03Div.classList.remove("selected");
			} else if (option === "SPLIT03") {
				split01Div.classList.remove("selected");
				split02Div.classList.remove("selected");
				split03Div.classList.add("selected");
			}
			
			setPayoutSplitGlow();
			
			var totalPayoutCheck = 2.4;
			var check = parseFloat((totalPayoutCheck - newPayoutRate - newInsuranceRate).toFixed(2));
			console.info("Check", check);
			
			if (check === 0) {
				payoutRate = newPayoutRate;
				insuranceRate = newInsuranceRate;
			} else {
				payoutRate = 0;
				insuranceRate = 0;
			}
			console.info("payoutRate", payoutRate);
			console.info("insuranceRate", insuranceRate);
			
			applyBoost("both", false);
			updateStatisticsDivs();
		}
		
		function calculateBoost() {
			console.info("Running calculateBoost()");
			
			boostAvailable = false;
			boostApplied = false;
			boostLevel = 0;
			boostRate = 0;
			
			//FORCE WIN STREAK
			//winStreak = 99;
			
			if (winStreak >= boostStreakLevelOne) {
				boostRate = boostBonusLevelOne - boostInsuranceRate;
				boostLevel = 1;
				boostAvailable = true;
				
				if (winStreak >= boostStreakLevelTwo) {
					boostRate = boostRate + boostBonusLevelTwoHop;
					boostLevel = 2;
				}
				
				if (winStreak >= boostStreakLevelThree) {
					boostRate = boostRate + boostBonusLevelThreeHop;
					boostLevel = 3;
				}
			} else {
				boostAvailable = false;
			}
			console.info("boostRate", boostRate);
		}
	
		//TODO: Dom Loaded
		var tokenRateToGBP = 1000;
		var playerCredit = 0;
		var payoutRate = 1.9; //2
		var insuranceRate = 0.5;
		var winStreak = 0;
		
		//Boost
		var boostAvailable = false;
		var boostApplied = false;
		var boostLevel = 0;
		var boostRate = 0;
		var boostInsurance = false;
		var boostInsuranceRateAvailable = 0.2; //0.1
		var boostInsuranceRate = 0;
		var boostStreakLevelOne = 1;
		var boostBonusLevelOne = 0.3; //0.2
		var boostStreakLevelTwo = 2;
		var boostBonusLevelTwoHop = 0.1;
		var boostStreakLevelThree = 3;
		var boostBonusLevelThreeHop = 0.1;
		
		var payoutBoostRate = 0;
		var insuranceBoostRate = 0;
		
		var payoutSplitCode = "SPLIT02";
		
		//Bag size (should be an even number)
		var bagSize = 24;
		
		var errors = [];
		
		var payoutBoost = false;
		var insuranceBoost = false;
		
		//When did we last show the end of credit message?
		var lastShowOverlayEndOfCreditBetId = 0;
		
		//TESTING
		//boostStreakLevelOne = 0;
			
		var statistics = {
			gamesPlayed: 0,
			totalStake: 0,
			houseBalance: 0,
			playerWinnings: 0,
			playerTotalWinnings: 0,
			playerBalance: 0,
			audit: [] 
		}
		
		var lastPicks = [];
		
		var custCreditDiv = document.getElementById("cust-credit");
		var custWinningsDiv = document.getElementById("cust-winnings");
		var custTotalWinningsDiv = document.getElementById("cust-total-winnings");
		var houseBalanceDebugDiv = document.getElementById("house-balance-debug");
		var houseCashDebugDiv = document.getElementById("house-cash-debug");
		var custBalanceDebugDiv = document.getElementById("cust-balance-debug");
		var custCashDebugDiv = document.getElementById("cust-cash-debug");
		
		var winStreakDiv = document.getElementById("win-streak");
		var boostAvailDiv = document.getElementById("boost-avail");
		var boostAppliedDiv = document.getElementById("boost-applied");
		var boostLevelDiv = document.getElementById("boost-level");
		var boostPctDiv = document.getElementById("boost-pct");
		var boostInsuranceDiv = document.getElementById("boost-insurance");
		var boostInsuranceMultiplierDiv = document.getElementById("boost-insurance-multiplier");
		
		var payoutPctDiv = document.getElementById("payout-pct");
		var insurancePctDiv = document.getElementById("insurance-pct");
		var payoutMultiplierDiv = document.getElementById("payout-multiplier");
		var insuranceMultiplierDiv = document.getElementById("insurance-multiplier");
		
		var payoutBonusDiv = document.getElementById("payout-bonus");
		var insuranceBonusDiv = document.getElementById("insurance-bonus");
		
		var payoutBoostIconsDiv = document.getElementById("payout-boost-icons");
		var payoutBoostIcon1Div = document.getElementById("payout-boost-icon-1");
		var payoutBoostIcon2Div = document.getElementById("payout-boost-icon-2");
		var payoutBoostIcon3Div = document.getElementById("payout-boost-icon-3");
		
		var insuranceBoostIconsDiv = document.getElementById("insurance-boost-icons");
		var insuranceBoostIcon1Div = document.getElementById("insurance-boost-icon-1");
		var insuranceBoostIcon2Div = document.getElementById("insurance-boost-icon-2");
		var insuranceBoostIcon3Div = document.getElementById("insurance-boost-icon-3");
		
		var colaInsuranceBonusSmallBtn = document.getElementById("cola-insurance-bonus-small-btn");
		var colaPayoutBonusSmallBtn = document.getElementById("cola-payout-bonus-small-btn");
		var colaInsuranceBonusLargeBtn = document.getElementById("cola-insurance-bonus-large-btn");
		var colaPayoutBonusLargeBtn = document.getElementById("cola-payout-bonus-large-btn");
		
		var colaPayoutBonusSmallDiv = document.getElementById("cola-payout-bonus-small");
		var colaInsuranceBonusSmallDiv = document.getElementById("cola-insurance-bonus-small");
		var colaPayoutBonusLargeDiv = document.getElementById("cola-payout-bonus-large");
		var colaInsuranceBonusLargeDiv = document.getElementById("cola-insurance-bonus-large");
		
		var boostGraphic1Span = document.getElementById("boost-graphic-1");
		var boostGraphic2Span = document.getElementById("boost-graphic-2");
		var boostGraphic3Span = document.getElementById("boost-graphic-3");
		
		var winStreakNumSpan = document.getElementById("win-streak-num");
		var winStreakTextSpan = document.getElementById("win-streak-text");
		
		var errorContainerDiv = document.getElementById("error-container");
		var errorContentDiv = document.getElementById("error-content");
		
		var outcomeImages = document.getElementById("outcome-images");
		var sweetImage1Div = document.getElementById("sweet-image1");
		var sweetImage2Div = document.getElementById("sweet-image2");
		
		var payoutBoostPct1Div = document.getElementById("payout-boost-pct-1");
		var payoutBoostPct2Div = document.getElementById("payout-boost-pct-2");
		var payoutBoostPct3Div = document.getElementById("payout-boost-pct-3");
		var insuranceBoostPct1Div = document.getElementById("insurance-boost-pct-1");
		var insuranceBoostPct2Div = document.getElementById("insurance-boost-pct-2");
		var insuranceBoostPct3Div = document.getElementById("insurance-boost-pct-3");
		
		var creditButtonDiv = document.getElementById("credit-button");
		var convertWinningsToCreditButtonDiv = document.getElementById("convert-winnings-to-credit-button");
		
		var split01Div = document.getElementById("payout-split-bar-250-0");
		var split02Div = document.getElementById("payout-split-bar-200-50");
		var split03Div = document.getElementById("payout-split-bar-150-100");
		
		updatePayoutSplit(1.9, 0.5, "SPLIT02"); //2, 0.5
		insuranceSwitch(false);
		calculateBoost();
		updateStatisticsDivs();
		
		var betId = 0;
		
		function addCredit(credit=0) {
		
			//Add Credit
			playerCredit = (playerCredit * 1) + (credit * 1);
			
			//Setup Messages
			var creditErrors = [];
			creditErrors.push("Added " + credit + " Tokens...");
			
			displayErrors(errorContainerDiv, errorContentDiv, "DEPOSIT SUCCESS!", creditErrors, 3000);
			updateStatisticsDivs();
			return playerCredit;
		}
		
		function convertWinnings() {
		
			var additionalCredit = statistics.playerWinnings;;
		
			playerCredit = playerCredit + additionalCredit;
			console.info("increased playerCredit by ", additionalCredit);
			
			statistics.playerWinnings = 0;
			console.info("Reset playerWinnings to ", statistics.playerWinnings);
			
			//Setup Messages
			var convertErrors = [];
			convertErrors.push("Converted " + additionalCredit + " Tokens to Credits...");
			
			displayErrors(errorContainerDiv, errorContentDiv, "CONGRATULATIONS!", convertErrors, 3000);
			
			updateStatisticsDivs();
			
			return statistics.playerWinnings;
		}
		
		function displayErrors(containerDiv, contentDiv, errorHeaderText, errorMessages, displayForMS) {
		
			console.info("Running displayErrors...");
			console.info("errorHeaderText", errorHeaderText);
			console.info("errorMessages", errorMessages);
			console.info("displayForMS", displayForMS);
		
			//Set HTML for Header
			contentDiv.innerHTML = "<h1>" + errorHeaderText + "</h1>";
			
			//Set HTML for Messages
			if (errorMessages.length > 0) {
				for (var i = 0; i < errorMessages.length; i++) {
					var errorText = errorMessages[i];
					
					contentDiv.innerHTML = contentDiv.innerHTML + "<div>" + errorText.toUpperCase() + "</div>";
				}
			}
			
			//Display Container
			containerDiv.style.display = "block";
			
			setTimeout(() => {
				containerDiv.style.display = "none";
			}, displayForMS);
			
		}
		
		function insuranceSwitch(checked=true) {
			//We always want to let them switch it on... but only off if the winstreak is 0
			if ((winStreak === 0 && !checked) || checked) {
				boostInsurance = checked;
				boostInsuranceRate = boostInsurance ? boostInsuranceRate = boostInsuranceRateAvailable : 0;
				calculateBoost();
				updateStatisticsDivs();
			} else {
				console.info("Not allowed...");
				//Forcing the box back to old state...
				var boostInsuranceCheckbox = document.getElementById("boost-insurance-checkbox");
				boostInsuranceCheckbox.checked = !checked;
			}
		}
		
		function applyBoost(type="", outcome=false) {
		
			var payoutSplitBar250GreenBoostDiv = document.getElementById("payout-split-bar-250-0-green-boost");
			var payoutSplitBar200GreenBoostDiv = document.getElementById("payout-split-bar-200-50-green-boost");
			var payoutSplitBar200RedBoostDiv = document.getElementById("payout-split-bar-200-50-red-boost");
			var payoutSplitBar150GreenBoostDiv = document.getElementById("payout-split-bar-150-100-green-boost");
			var payoutSplitBar150RedBoostDiv = document.getElementById("payout-split-bar-150-100-red-boost");
		
			if (type === "payout") {
				console.info("BOOSTING PAYOUT TO", boostRate);
				payoutBoost = outcome;
				boostApplied = true;
				insuranceBoost = false;
				
				payoutSplitBar250GreenBoostDiv.style.width = (((boostRate * 100) / 290) * 100).toFixed(0) + "%";
				payoutSplitBar200GreenBoostDiv.style.width = (((boostRate * 100) / 290) * 100).toFixed(0) + "%";
				payoutSplitBar150GreenBoostDiv.style.width = (((boostRate * 100) / 290) * 100).toFixed(0) + "%";
				payoutSplitBar200RedBoostDiv.style.width = 0 + "%";
				payoutSplitBar150RedBoostDiv.style.width = 0 + "%";
				
			} else if (type === "insurance") {
				console.info("BOOSTING INSURANCE TO", boostRate);
				boostApplied = true;
				payoutBoost = false;
				insuranceBoost = outcome;
				
				payoutSplitBar250GreenBoostDiv.style.width = 0 + "%";
				payoutSplitBar200GreenBoostDiv.style.width = 0 + "%";
				payoutSplitBar150GreenBoostDiv.style.width = 0 + "%";
				payoutSplitBar200RedBoostDiv.style.width = (((boostRate * 100) / 290) * 100).toFixed(0) + "%";
				payoutSplitBar150RedBoostDiv.style.width = (((boostRate * 100) / 290) * 100).toFixed(0) + "%";
				
				
			} else if (type === "both" && outcome === false) {
				boostApplied = false;
				payoutBoost = outcome;
				insuranceBoost = outcome;
				
				var boostPayoutDivLocal = document.getElementById("boost-payout");
				var insurancePayoutDivLocal = document.getElementById("insurance-payout");
				boostPayoutDivLocal.checked = false;
				insurancePayoutDivLocal.checked = false;
				
				payoutSplitBar200RedBoostDiv.style.width = 0 + "%";
				payoutSplitBar150RedBoostDiv.style.width = 0 + "%";
				payoutSplitBar250GreenBoostDiv.style.width = 0 + "%";
				payoutSplitBar200GreenBoostDiv.style.width = 0 + "%";
				payoutSplitBar150GreenBoostDiv.style.width = 0 + "%";
			} else {
				payoutSplitBar200RedBoostDiv.style.width = 0 + "%";
				payoutSplitBar150RedBoostDiv.style.width = 0 + "%";
				payoutSplitBar250GreenBoostDiv.style.width = 0 + "%";
				payoutSplitBar200GreenBoostDiv.style.width = 0 + "%";
				payoutSplitBar150GreenBoostDiv.style.width = 0 + "%";
			}
			
			
			//HERE do the glowing bits?
			setPayoutSplitGlow();
			updateStatisticsDivs();
		}
		
		function pickSweets(stake=1, bet=0/*, payoutBoost=false, insuranceBoost=false*/) {
		
			//Clear Errors
			clearErrors(errorContainerDiv, errorContentDiv);
		
			console.info("stake", stake);
			console.info("bet", bet);
			console.info("payoutBoost", payoutBoost);
			console.info("insuranceRate", insuranceRate);
			console.info("insuranceBoost", insuranceBoost);
			
			var payout = 0;
			var housePayout = 0;
			var outcome = "";
			
			if (payoutBoost && !insuranceBoost) {
				payoutBoostRate = boostRate;
				insuranceBoostRate = 0;
			} else if (!payoutBoost && insuranceBoost) {
				payoutBoostRate = 0;
				insuranceBoostRate = boostRate;
			} else {
				payoutBoostRate = 0;
				insuranceBoostRate = 0;
			}
			
			var stakeDiv = document.getElementById("stake");
			var betDiv = document.getElementById("bet");			
			var resultDiv = document.getElementById("result");
			var payoutDiv = document.getElementById("payout");
			var resultDescriptionDiv = document.getElementById("result-description");

			if ((bet === "Cola" || bet === "Cherry") && stake !== 0 && (playerCredit - stake >= 0))
			{
				resultDiv.style.display = "none";
				resultDiv.innerHTML = "";
				resultDiv.classList.remove("win");
				resultDiv.classList.remove("lose");
				resultDiv.classList.remove("insurance");
				
				resultDescriptionDiv.style.display = "none";
				resultDescriptionDiv.innerHTML = "";
				resultDescriptionDiv.classList.remove("win");
				resultDescriptionDiv.classList.remove("lose");
				resultDescriptionDiv.classList.remove("insurance");
				
				payoutDiv.style.display = "none";
				payoutDiv.innerHTML = "";
				payoutDiv.classList.remove("win");
				payoutDiv.classList.remove("lose");
				payoutDiv.classList.remove("insurance");
				
				stakeDiv.style.display = "flex";
				stakeDiv.innerHTML = "Stake: " + stake;
				
				betDiv.style.display = "flex";
				betDiv.innerHTML = "Bet: " + bet;
				
				outcomeImages.style.display = "none"
				
				var delayInMs = 700; //1500 Default (1.5s) seems good...
				
				//TODO: At the start of the timer, add a "Betting" overlay...
				showOverlay();
				
				setTimeout(() => {
					hideOverlay();
				
					//Start of Delay...
					betId++;
				
					playerCredit = playerCredit - stake;
					console.info("Updating player credit", playerCredit);
				
					//playerCredit = playerCredit - stake;
					custCreditDiv.innerHTML = "Credit: " + playerCredit + " Tokens";
				
					//Consider how to randomize (or not randomize) the sweets going in. Pattern may be important
					//Do we make the names even more similar so people maybe think they've won for a sec when they haven't?
					var sweets = [];
					
					for (var i = 0; i < bagSize; i++) {
						if (((i+1) % 2) != 0) {
							sweets.push("Cola");
						} else {
							sweets.push("Cherry");
						}
					}
					
					//Pick first sweet
					var pickIndex1 = Math.floor(Math.random() * sweets.length);
					var pickElement1 = sweets[pickIndex1];
					
					//Remove first sweet
					sweets.splice(pickIndex1, 1);
					
					//Pick first sweet
					var pickIndex2 = Math.floor(Math.random() * sweets.length);
					var pickElement2 = sweets[pickIndex2];
					
					//Remove second sweet
					sweets.splice(pickIndex1, 1);
					
					//pickedSweets object
					var pickedSweets = {
						"Sweet1": pickElement1,
						"Sweet2": pickElement2
					}
					
					//FORCE CHERRY
					/*
					var pickedSweets = {
						"Sweet1": "Cherry",
						"Sweet2": "Cherry"
					};
					*/
					
					//FORCE COLA
					/*
					var pickedSweets = {
						"Sweet1": "Cola",
						"Sweet2": "Cola"
					};
					*/
					
					//FORCE MIXED
					/*
					var pickedSweets = {
						"Sweet1": "Cherry",
						"Sweet2": "Cola"
					};
					*/
					
					//FORCE CORRECT
					/*
					var pickedSweets = {
						"Sweet1": bet,
						"Sweet2": bet
					}
					*/
					
					renderSweets(pickedSweets.Sweet1, pickedSweets.Sweet2);
					
					//TODO: Try: 2 and 0 (with the option for the person to change to 1.5 / 0.5 or whatever slider they fancy?)
					//TODO: Try: 2.0 and 0.1 to 0.2
					//TODO: Just give them 2.2 in total to play with, they can split it how they want (within reason... win must be higher than insurance)
					//TODO: Have I misunderstood... it's fine if the customer balance is higher than the house balance because they put ALL the money in...
					//TODO: ...the problem is when the house balance drops below 0
					
					if (pickedSweets.Sweet1 === pickedSweets.Sweet2) {
						console.info("Matching");
						if (pickedSweets.Sweet1 === bet) {
							outcome = "win";
							payout = stake * (payoutRate + payoutBoostRate), 2;
							housePayout = stake - payout, 2;
							winStreak++;
							console.info("Bet wins!");
							console.info("payoutRate", payoutRate);
							console.info("payout", payout);
							
							resultDiv.classList.add("win");
							resultDiv.style.display = "flex";
							resultDiv.innerHTML = "Won!";
							
							resultDescriptionDiv.classList.add("win");
							resultDescriptionDiv.style.display = "flex";
							resultDescriptionDiv.innerHTML = "You backed " + bet + ". Picked sweets were both " + pickedSweets.Sweet1 + ". Therefore you won " + payout + " Tokens this time.";
							
							payoutDiv.classList.add("win");
							payoutDiv.style.display = "flex";
							payoutDiv.innerHTML = "+" + payout + " Tokens";
							
							//Animate Points
							animatePoints(stake, payoutRate, 100, "white");
							animatePoints(stake, payoutBoostRate, 100, (boostLevel == 1 ? "yellow" : boostLevel == 2 ? "orange" : boostLevel == 3 ? "red" : "white"));
							
						} else {
							outcome = "loss";
							housePayout = stake;
							winStreak = 0;
							console.info("Bet loses.");
							console.info("payoutRate", payoutRate);
							console.info("payout", payout);
							
							resultDiv.classList.add("lose");
							resultDiv.style.display = "flex";
							resultDiv.innerHTML = "Unlucky";
							
							resultDescriptionDiv.classList.add("lose");
							resultDescriptionDiv.style.display = "flex";
							resultDescriptionDiv.innerHTML = "You backed " + bet + ". Picked sweets were both " + pickedSweets.Sweet1 + ". Therefore you didn't win any tokens this time.";
							
							payoutDiv.classList.add("lose");
							payoutDiv.style.display = "flex";
							payoutDiv.innerHTML = "+" + payout + " Tokens";
						}
					} else {	
							//We don't even display this as a loss... even if they don't have insurance... perhaps they should have done.
							outcome = "insurance";
							payout = stake * (insuranceRate + insuranceBoostRate), 2;
							housePayout = stake - payout, 2;
							winStreak = boostInsurance ? winStreak : 0;
							console.info("Bet loses.");
							console.info("insuranceRate", insuranceRate);
							console.info("payout", payout);
							
							resultDiv.classList.add("insurance");
							resultDiv.style.display = "flex";
							resultDiv.innerHTML = insuranceRate != 0 ? "Insurance" : "Insurance*";
							
							resultDescriptionDiv.classList.add("insurance");
							resultDescriptionDiv.style.display = "flex";
							resultDescriptionDiv.innerHTML = insuranceRate != 0 ? "You backed " + bet + ". Picked sweets were mixed, so insurance paid out " + payout + " Tokens." : "You backed " + bet + ". Picked sweets were mixed. Whilst insurance would have paid here, there was no cover included in the selected payout split.";
							
							payoutDiv.classList.add("insurance");
							payoutDiv.style.display = "flex";
							payoutDiv.innerHTML = "+" + payout + " Tokens";
							
							//Animate Points
							animatePoints(stake, insuranceRate, 50, "white");
							animatePoints(stake, insuranceBoostRate, 50, (boostLevel == 1 ? "yellow" : boostLevel == 2 ? "orange" : boostLevel == 3 ? "red" : "white"));
					}
					
					//Statistics
					var auditObject = {
						"id": betId,
						"bet": bet,
						"stake": stake,
						"payoutRate": payoutRate,
						"payoutBoostRate": payoutBoostRate,
						"insuranceRate": insuranceRate,
						"insuranceBoostRate": insuranceBoostRate,
						"pickedSweets": pickedSweets,
						"outcome": outcome,
						"payout": payout,
						"housePayout": housePayout,
						"boostInsurance": boostInsurance
					}
					
					statistics.audit.push(auditObject);
					
					statistics.gamesPlayed++;
					statistics.totalStake = statistics.totalStake + stake;
					statistics.houseBalance = statistics.houseBalance + housePayout;
					statistics.playerWinnings = statistics.playerWinnings + payout;
					console.info("###### statistics.playerWinnings", statistics.playerWinnings);
					console.info("###### payout", payout);
					
					statistics.playerTotalWinnings = statistics.playerTotalWinnings + payout;
					statistics.playerBalance = statistics.playerBalance + payout - stake;
					
					//Last picks Array
					var lastPicksMaxSize = 7;
					var lastPickRecord = JSON.parse(JSON.stringify(pickedSweets));
					lastPickRecord.Outcome = outcome;
					
					if (lastPicks.length >= lastPicksMaxSize) {
						lastPicks.shift();
					}
					lastPicks.push(lastPickRecord);
					
					//Console output
					console.info("auditObject", auditObject);
					console.info("statistics", statistics);
					console.info("lastPicks", lastPicks);
					
					//Cheeky - unselect their boost each time...
					applyBoost("both", false);
					
					calculateBoost();
					updateStatisticsDivs();
					renderLastPicks();
					
					return pickedSweets;
					//End of Delay
				}, delayInMs);
			} else {
			
				//End of game stats overlay...
				console.info("playerCredit", playerCredit);
				console.info("statistics.gamesPlayed", statistics.gamesPlayed);
				console.info("lastShowOverlayEndOfCreditBetId", lastShowOverlayEndOfCreditBetId);
				console.info("betId", betId);
				if (playerCredit <= 0 && statistics.gamesPlayed > 0) {
					showOverlayEndOfCredit();
				}
				
				var pickSweetsErrors = [];
				
				if (bet !== "Cola" && bet !== "Cherry") {
					pickSweetsErrors.push("Invalid bet, option must be 'Cola' or 'Cherry'...");
				}
				
				if (stake === 0) {
					pickSweetsErrors.push("No stake provided with bet...");
				}
				
				if (playerCredit - stake < 0) {
					pickSweetsErrors.push("Insufficient Credit! Please add more to play or choose a lower stake...");
				}
				
				displayErrors(errorContainerDiv, errorContentDiv, "ATTENTION!", pickSweetsErrors, 3000);
				return false;
			}
		}
		
		function renderLastPicks() {
			const container = document.getElementById("last-picks-display");
			container.innerHTML = ""; // Clear previous content
			
			//Reverse the array before rendering
			//var reversedPicks = [...lastPicks].reverse();
			
			lastPicks.forEach((pick, index) => {
				const isLast = index === lastPicks.length - 1; // Check if it's the last pick

				if (!isLast) {
					// Previous Sweets
					const entry = document.createElement("div");
					entry.classList.add("last-picks-entry");

					const sweet1 = document.createElement("span");
					sweet1.classList.add(`last-picks-${pick.Sweet1.toLowerCase()}`);

					const sweet2 = document.createElement("span");
					sweet2.classList.add(`last-picks-${pick.Sweet2.toLowerCase()}`);

					// Add outcome-based class to apply highlighting
					if (pick.Outcome === "win") {
						entry.classList.add("last-picks-win");
					} else if (pick.Outcome === "loss") {
						entry.classList.add("last-picks-loss");
					} else if (pick.Outcome === "insurance") {
						entry.classList.add("last-picks-insurance");
					}

					entry.append(sweet1);
					entry.append(sweet2);
					container.appendChild(entry);
				} else {
					// Latest Pick (Last Element)
					const containerLatest = document.getElementById("last-picks-display-latest");
					containerLatest.innerHTML = ""; // Clear previous content

					const entryLatest = document.createElement("div");
					entryLatest.classList.add("last-picks-entry", "latest");

					const sweet1 = document.createElement("span");
					sweet1.classList.add(`last-picks-${pick.Sweet1.toLowerCase()}`);

					const sweet2 = document.createElement("span");
					sweet2.classList.add(`last-picks-${pick.Sweet2.toLowerCase()}`);

					// Add outcome-based class to apply highlighting
					if (pick.Outcome === "win") {
						entryLatest.classList.add("last-picks-win");
					} else if (pick.Outcome === "loss") {
						entryLatest.classList.add("last-picks-loss");
					} else if (pick.Outcome === "insurance") {
						entryLatest.classList.add("last-picks-insurance");
					}

					sweet1.classList.add("latest-entry");
					sweet2.classList.add("latest-entry");

					entryLatest.appendChild(sweet1);
					entryLatest.appendChild(sweet2);
					containerLatest.appendChild(entryLatest);
				}
			});

		}
		
		function renderSweets(sweet1="", sweet2="") {
			if ((sweet1 === "Cherry" || sweet1 === "Cola") && (sweet2 === "Cherry" || sweet2 === "Cola")) {
				outcomeImages.style.display = "flex"
				sweetImage1Div.innerHTML = "<div class='sweet-image' style='display: inline-flex' id='sweet-image1'><img src='images/" + sweet1.toLowerCase() + ".png' alt='" + sweet1.toLowerCase() + " Icon' height='80px'></div>";
				sweetImage2Div.innerHTML = "<div class='sweet-image' style='display: inline-flex' id='sweet-image2'><img src='images/" + sweet2.toLowerCase() + ".png' alt='" + sweet2.toLowerCase() + " Icon' height='80px'></div>";
			}
		}
		
		function clearErrors(containerDiv=null, contentDiv=null) {
			console.info("Running clearErrors");
			//errors = [];
			contentDiv.innerHTML = "";
			containerDiv.style.display = "none";
		}
		
		function showOverlayEndOfCredit() {
			copyDivContent("debug", "overlay-end-of-credit-content");
			
			var overlayEndOfCredit = document.getElementById("overlay-end-of-credit");
			overlayEndOfCredit.style.visibility = "visible";
		}
		
		function hideOverlayDismiss() {
			console.info("Running hideOverlayDismiss()");
			
			var overlayEndOfCredit = document.getElementById("overlay-end-of-credit");
			overlayEndOfCredit.style.visibility = "hidden";
		}

		
		function showOverlay() {
			console.info("Running showOverlay()");
			
			var overlay = document.getElementById("overlay");
			var imagesContainer = document.getElementById("overlay-images");
			var images = ["images/cherry.png", "images/cola.png"];
			//var totalInstances = bagSize;
			var totalInstances = 4;
			var iteration = 0;
			
			// Clear any existing images (if this is called multiple times)
			imagesContainer.innerHTML = "";
			
			// Create and append the image elements dynamically
			for (let i = 0; i < totalInstances; i++) {
				var img = document.createElement("img");
				img.src = images[i % images.length]; // Alternate between image1 and image2
				img.className = "overlay-image";
				imagesContainer.appendChild(img);
			}

			// Show the overlay
			overlay.style.visibility = "visible";
			
			// Start the image update loop
			var intervalId = setInterval(() => {
				var imgElements = document.querySelectorAll(".overlay-image");
				imgElements.forEach((img, index) => {
					// Alternate images based on the iteration
					var newIndex = (iteration + index) % images.length;
					img.src = images[newIndex];
				});
				iteration++;
			}, 150);

			// Save the interval ID so we can clear it when hiding the overlay
			overlay.dataset.intervalId = intervalId;
		}
		
		function hideOverlay() {
			console.info("Running hideOverlay()");
			
			var overlay = document.getElementById("overlay");
			overlay.style.visibility = "hidden";
			
			// Clear the interval for image updates
			var intervalId = overlay.dataset.intervalId;
			if (intervalId) {
				clearInterval(intervalId);
				delete overlay.dataset.intervalId;
			}
		}
		
		function copyDivContent(originalId, newParentId) {
			// Get the original div by its ID
			const originalDiv = document.getElementById(originalId);
			if (!originalDiv) {
				console.error("Original div not found!");
				return;
			}

			// Clone the original div, including all child nodes
			const clonedDiv = originalDiv.cloneNode(true);

			// Generate a new ID for the cloned div to prevent duplication of IDs
			clonedDiv.id = originalId + "-clone"; // You can customize the new ID pattern

			// Get the new parent element where the cloned div will be placed
			const newParent = document.getElementById(newParentId);
			if (!newParent) {
				console.error("New parent div not found!");
				return;
			}
			
			// Clear existing content
			newParent.innerHTML = "";

			// Append the cloned div to the new parent
			newParent.appendChild(clonedDiv);
		}
		
		function createFlyingText(content, textColor) {
			const container = document.querySelector('.flying-text-container');
			const flyingText = document.createElement('div');
			flyingText.classList.add('flying-text');
			flyingText.textContent = content;
			flyingText.style.color = textColor;

			// Randomize the X and Y direction for the flying text
			const randomX = (Math.random() - 0.5) * 300; // Random X direction (further distance)
			const randomY = (Math.random() - 0.5) * 300; // Random Y direction (further distance)

			// Set the random values to CSS custom properties for animation
			flyingText.style.setProperty('--x', `${randomX}px`);
			flyingText.style.setProperty('--y', `${randomY}px`);

			// Append the flying text to the container
			container.appendChild(flyingText);

			// Remove the element after animation ends
			flyingText.addEventListener('animationend', () => {
				flyingText.remove();
			});
		}
		
		function animatePoints(stake, rate, splitPointsAt, textColor) {
		
			//Animate Points
			var tempPayout = stake * rate;
			if (tempPayout > 0) {
				
				var tempPayoutChunks = ((tempPayout / splitPointsAt).toFixed(0) * 1);
				console.info(">> tempPayoutChunks", tempPayoutChunks);
				
				for (var i = 0; i < tempPayoutChunks; i++) {
					createFlyingText("+" + splitPointsAt, textColor);
				}
				
				var remainder = ((tempPayout % splitPointsAt).toFixed(0) * 1);
				if (remainder !== 0) {
					createFlyingText("+" + remainder, textColor);
				}
			}
		
		}
		
		function setPayoutSplitGlow() {
			console.info("Running setPayoutSplitGlow");
			console.info("boostRate", boostRate);
			console.info("payoutBoostRate", payoutBoostRate);
			console.info("insuranceBoostRate", insuranceBoostRate);
			console.info("payoutSplitCode", payoutSplitCode);
			console.info("boostLevel", boostLevel);
			
			if (boostRate > 0) {
				if (payoutSplitCode === "SPLIT01") {
					if (boostLevel == 1 && boostApplied) {
						split01Div.classList.add("yellow-glow");
					} else if (boostLevel == 2 && boostApplied) {
						split01Div.classList.add("orange-glow");
					} else if (boostLevel == 3 && boostApplied) {
						split01Div.classList.add("red-glow");
					} else {
						split01Div.classList.remove("yellow-glow");
						split01Div.classList.remove("orange-glow");
						split01Div.classList.remove("red-glow");
					}
				} else if (payoutSplitCode === "SPLIT02") {
					if (boostLevel == 1 && boostApplied) {
						split02Div.classList.add("yellow-glow");
					} else if (boostLevel == 2 && boostApplied) {
						split02Div.classList.add("orange-glow");
					} else if (boostLevel == 3 && boostApplied) {
						split02Div.classList.add("red-glow");
					} else {
						split02Div.classList.remove("yellow-glow");
						split02Div.classList.remove("orange-glow");
						split02Div.classList.remove("red-glow");
					}
				} else if (payoutSplitCode === "SPLIT03") {
					if (boostLevel == 1 && boostApplied) {
						split03Div.classList.add("yellow-glow");
					} else if (boostLevel == 2 && boostApplied) {
						split03Div.classList.add("orange-glow");
					} else if (boostLevel == 3 && boostApplied) {
						split03Div.classList.add("red-glow");
					} else {
						split03Div.classList.remove("yellow-glow");
						split03Div.classList.remove("orange-glow");
						split03Div.classList.remove("red-glow");
					}
				}
			} else {
				split01Div.classList.remove("yellow-glow");
				split01Div.classList.remove("orange-glow");
				split01Div.classList.remove("red-glow");
				
				split02Div.classList.remove("yellow-glow");
				split02Div.classList.remove("orange-glow");
				split02Div.classList.remove("red-glow");
				
				split03Div.classList.remove("yellow-glow");
				split03Div.classList.remove("orange-glow");
				split03Div.classList.remove("red-glow");
			}
		}
		
	</script>
  </body>
</html>
